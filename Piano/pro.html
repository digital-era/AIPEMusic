<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>跨越时空的对话：肖邦 x 李白</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap">
    <style>
        :root {
            --bg-space-dark: #0a0e17;
            --bg-space-deep: #131829;
            --bg-space-mid: #1d2438;
            --bg-space-light: #2a3450;
            --text-dim: rgba(255, 255, 255, 0.35);
            --text-active: #ffffff;
            --gold-base: #d4af37;
            --gold-shine: #ffd700;
            --gold-pale: #f0e6d2;
            --font-cn: "Noto Serif SC", "Songti SC", "STSong", "SimSun", serif;
            --font-en: "Playfair Display", "Times New Roman", serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: linear-gradient(135deg, var(--bg-space-dark) 0%, var(--bg-space-deep) 30%, var(--bg-space-mid) 70%, var(--bg-space-light) 100%);
            overflow-x: hidden;
            line-height: 1.8;
            min-height: 100vh;
            width: 100vw;
            font-family: var(--font-cn);
            color: var(--text-active);
            position: relative;
            -webkit-text-size-adjust: 100%;
        }

        .space-gradient, .star-halo, .texture-overlay, .star-noise {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
        }

        .space-gradient { z-index: -2; }
        .star-halo { z-index: -1; filter: blur(20px); }
        .texture-overlay { z-index: 1; opacity: 0.15; mix-blend-mode: overlay; }
        .star-noise { z-index: 0; opacity: 0.25; mix-blend-mode: screen; }

        .initial-cover {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #0a0e17 0%, #131829 30%, #1d2438 70%, #2a3450 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 1.5s ease-out, transform 1.5s ease-out;
            pointer-events: none;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 100px 10px 150px;
            position: relative;
            z-index: 2;
            opacity: 0;
            animation: fadeInUp 1.5s ease 1.5s forwards;
        }

        header { text-align: center; margin-bottom: 40px; }
        h1 {
            font-size: 3.5rem;
            letter-spacing: 10px;
            color: var(--text-active);
            text-shadow: 0 0 30px rgba(212,175,55,0.4);
        }

        .subtitle {
            font-family: var(--font-en);
            font-size: 1.3rem;
            color: var(--gold-pale);
            font-style: italic;
            letter-spacing: 2px;
        }

        .player-wrapper {
            position: sticky;
            top: 20px;
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 0 auto 60px;
            background: rgba(255,255,255,0.08);
            padding: 12px 32px;
            border-radius: 50px;
            backdrop-filter: blur(25px);
            border: 1px solid rgba(212,175,55,0.25);
            width: fit-content;
            min-width: 350px;
        }

        .poem-container {
            text-align: center;
            width: 100%;
        }

        .poem-line {
            font-size: 1.6rem;
            margin: 35px 0;
            color: rgba(255,255,255,0.45);
            transition: all 0.5s cubic-bezier(0.4,0,0.2,1);
            line-height: 1.8;
            font-weight: 300;
            letter-spacing: 1px;
        }

        .poem-line.active {
            color: var(--gold-shine);
            transform: scale(1.05);
            font-weight: 400;
        }

        /* 移动端优化 */
        @media (max-width: 600px) {
            .container {
                padding: 50px 12px 80px;
            }

            h1 { font-size: 2.2rem; letter-spacing: 5px; }

            .subtitle { font-size: 1rem; }

            .player-wrapper {
                width: 90%;
                max-width: 280px;
                padding: 8px 16px;
                gap: 10px;
                border-radius: 30px;
            }

            .poem-line {
                font-size: 1.15rem;
                margin: 20px 0;
                line-height: 1.55;
                padding: 0 10px;
                text-align: center !important;
                white-space: pre-wrap;
                word-break: keep-all;
                letter-spacing: 0.4px;
            }

            /* 前两句特别处理：尽量不换行，字体稍小一点 */
            .poem-line:nth-child(1),
            .poem-line:nth-child(2) {
                white-space: nowrap;
                font-size: 1.1rem;
                overflow: hidden;
                text-overflow: ellipsis;
                max-width: 100%;
            }

            .poem-line.active {
                transform: scale(1.02);
            }
        }

        @media (max-width: 400px) {
            .poem-line {
                font-size: 1.05rem;
                margin: 18px 0;
            }
            .poem-line:nth-child(1),
            .poem-line:nth-child(2) {
                font-size: 1.0rem;
            }
        }

        @keyframes fadeInUp {
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

<div class="space-gradient"></div>
<div class="star-halo"></div>
<div class="texture-overlay chinese" id="texture-overlay"></div>
<div class="star-noise"></div>

<!-- 初始封面 -->
<div class="initial-cover" id="initial-cover">
    <div class="cover-content">
        <div class="cover-title">将进酒</div>
        <div class="cover-subtitle">Xiao Bang · Li Bai</div>
    </div>
</div>

<div class="container">
    <header>
        <h1>将进酒</h1>
        <div class="subtitle" id="header-subtitle">Ballade No. 1 in G minor, Op. 23</div>
    </header>

    <!-- 播放控制器 -->
    <div class="player-wrapper" id="player-wrapper">
        <button id="play-btn">播放 / 暂停</button>
        <div>
            <button id="track-piano" class="active">钢琴</button>
            <button id="track-opera">京剧</button>
        </div>
    </div>

    <!-- 诗词内容 -->
    <div class="poem-container" id="poem-box">
        <div class="poem-line">君不见，黄河之水天上来，奔流到海不复回。</div>
        <div class="poem-line">君不见，高堂明镜悲白发，朝如青丝暮成雪。</div>
        <div class="poem-line">人生得意须尽欢，莫使金樽空对月。</div>
        <div class="poem-line">天生我材必有用，千金散尽还复来。</div>
        <div class="poem-line">烹羊宰牛且为乐，会须一饮三百杯。</div>
        <div class="poem-line">岑夫子，丹丘生，将进酒，杯莫停。</div>
        <div class="poem-line">与君歌一曲，请君为我倾耳听。</div>
        <div class="poem-line">钟鼓馔玉不足贵，但愿长醉不复醒。</div>
        <div class="poem-line">古来圣贤皆寂寞，惟有饮者留其名。</div>
        <div class="poem-line">陈王昔时宴平乐，斗酒十千恣欢谑。</div>
        <div class="poem-line">主人何为言少钱，径须沽取对君酌。</div>
        <div class="poem-line">五花马，千金裘，</div>
        <div class="poem-line">呼儿将出换美酒，与尔同销万古愁。</div>
    </div>
</div>

<audio id="audio-player" preload="none" loop></audio>

<script>
    const audio = document.getElementById('audio-player');
    const playBtn = document.getElementById('play-btn');
    const btnPiano = document.getElementById('track-piano');
    const btnOpera = document.getElementById('track-opera');
    const headerSubtitle = document.getElementById('header-subtitle');
    const poemLines = document.querySelectorAll('.poem-line');
    const textureOverlay = document.getElementById('texture-overlay');

    let currentTrack = 'piano';
    let isPlaying = false;
    let isSourceSet = false;

    const pianoUrl = 'Chopin - Ballade No.1 in G minor, Op.23 (Krystian Zimerman).mp3';
    const operaUrl = 'JiangJinJiu Peking Opera.mp3';

    // 时间点（仅用于播放时同步高亮）
    const lineTimes = [0, 12, 24, 34, 43, 52, 60, 68, 76, 88, 98, 108, 118, 128];

    function switchTrack(track) {
        if (currentTrack === track) return;
        currentTrack = track;

        btnPiano.classList.toggle('active', track === 'piano');
        btnOpera.classList.toggle('active', track === 'opera');

        headerSubtitle.textContent = track === 'piano'
            ? 'Ballade No. 1 in G minor, Op. 23'
            : '京剧念白·将进酒';

        textureOverlay.className = 'texture-overlay ' + (track === 'piano' ? 'western' : 'chinese');

        if (isPlaying) {
            audio.pause();
            isSourceSet = false;
            setTimeout(() => togglePlay(), 300);
        }
    }

    function togglePlay() {
        if (!isSourceSet) {
            audio.src = currentTrack === 'piano' ? pianoUrl : operaUrl;
            isSourceSet = true;
        }

        if (isPlaying) {
            audio.pause();
            isPlaying = false;
            playBtn.textContent = '播放';
            clearInterval(window.timeSyncInterval);
            poemLines.forEach(l => l.classList.remove('active'));
        } else {
            audio.play().catch(e => console.log('播放失败:', e));
            isPlaying = true;
            playBtn.textContent = '暂停';
            startTimeSync();
        }
    }

    function startTimeSync() {
        clearInterval(window.timeSyncInterval);
        window.timeSyncInterval = setInterval(() => {
            if (!isPlaying) return;
            const t = audio.currentTime;
            poemLines.forEach((line, i) => {
                line.classList.toggle('active', t >= (lineTimes[i] || 0));
            });
        }, 200);
    }

    // 彻底移除滚动时的高亮逻辑
    function initScrollHandler() {
        // 留空：不再根据滚动位置改变颜色
    }

    // 事件绑定
    document.getElementById('play-btn').onclick = togglePlay;
    btnPiano.onclick = () => switchTrack('piano');
    btnOpera.onclick = () => switchTrack('opera');

    // 初始隐藏封面
    window.addEventListener('load', () => {
        setTimeout(() => {
            document.getElementById('initial-cover').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('initial-cover').style.display = 'none';
            }, 1500);
        }, 2800);
    });

    initScrollHandler();
</script>
</body>
</html>
